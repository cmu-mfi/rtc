

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TEACH - Collecting Data &mdash; Robotics Training Center 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=9951d260" />
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" />

  
    <link rel="shortcut icon" href="../../_static/Firefly a robot arm doing assembly task, industry 4.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=30646c52"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="LEARN - Training a model" href="training-model.html" />
    <link rel="prev" title="Robot-Camera Calibration" href="calibration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Robotics Training Center
              <img src="../../_static/Firefly a robot arm doing assembly task, industry 4.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../System.html">System Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../System.html#cmu-research-setup">CMU Research Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../System.html#bom">BOM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Highlights.html">Video Highlights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Contact.html">Contact</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vision System</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Vision.html">Vision System - Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Vision.html#teach-data-collection">TEACH: Data Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Vision.html#learn-model-training">LEARN: Model Training</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Vision.html#data-input-for-training">Data input for training:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Vision.html#execute-model-inference">EXECUTE: Model Inference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Vision System - Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Installation.html#hardware">Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation.html#software">Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation.html#installation-steps">Installation Steps</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../Tutorial.html">Vision System - Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="calibration.html">Robot-Camera Calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#method-eye-on-base">Method: eye-on-base</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#method-eye-on-hand">Method: eye-on-hand</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#code-overview">Code Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#try-it-out">Try it out</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#useful-tips">Useful Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#calibration-algorithms">Calibration Algorithms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="calibration.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">TEACH - Collecting Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#method">Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-overview">Code Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#useful-tips">Useful Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="#try-it-out">Try it out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="training-model.html">LEARN - Training a model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="training-model.html#method">Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="training-model.html#code-overview">Code Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="training-model.html#configuration-files">Configuration Files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="training-model.html#try-it-out">Try it out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="execution.html">EXECUTE - Skill Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="execution.html#method">Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="execution.html#code-overview">Code Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="execution.html#useful-tips">Useful Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="execution.html#try-it-out">Try it out</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vibrotactile System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html">Vibrotactile System - Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#teach-data-collection">TEACH: Data Collection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#nist-data-collection">NIST Data Collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#lego-data-collection">LEGO Data Collection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#learn-model-training">LEARN: Model Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#execute-model-inference">EXECUTE: Model Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#waterproof-online-inference">Waterproof Online Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#d-sub-online-inference">D-SUB Online Inference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Vibrotactile/Installation.html">Vibrotactile System - Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Vibrotactile/Installation.html#hardware">Hardware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Installation.html#mandatory">Mandatory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Installation.html#optional">Optional</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Vibrotactile/Installation.html#software">Software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Installation.html#installation-steps">Installation Steps</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Digital Data Backbone</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../DDB/DDB.html">Digital Data Backbone - Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/DDB.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/DDB.html#layers">Layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/DDB.html#current-capability">Current Capability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/DDB.html#software">Software</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../DDB/Installation.html">DDB - Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/Installation.html#step-1-broker-setup-pub-sub-broker-layer">Step 1: Broker Setup (Pub-Sub Broker Layer)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/Installation.html#step-2-cloud-databases-cloud-storage-layer">Step 2: Cloud Databases (Cloud Storage Layer)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/Installation.html#aveva-pi-historian">Aveva PI Historian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/Installation.html#sql">SQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/Installation.html#cloud-file-storage">Cloud File Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/Installation.html#step-4-event-listeners">Step 4: Event Listeners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/Installation.html#step-5-retrieval-services">Step 5: Retrieval Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/Installation.html#system-checks-and-troubleshooting">System Checks and Troubleshooting</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Robotics Training Center</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Tutorial.html">Vision System - Tutorials</a></li>
      <li class="breadcrumb-item active">TEACH - Collecting Data</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/cmu-mfi/rtc/blob/main/doc/Vision/Tutorials/data-collection.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="teach-collecting-data">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">TEACH - Collecting Data</a><a class="headerlink" href="#teach-collecting-data" title="Link to this heading"></a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#teach-collecting-data" id="id1">TEACH - Collecting Data</a></p>
<ul>
<li><p><a class="reference internal" href="#method" id="id2">Method</a></p></li>
<li><p><a class="reference internal" href="#code-overview" id="id3">Code Overview</a></p></li>
<li><p><a class="reference internal" href="#useful-tips" id="id4">Useful Tips</a></p></li>
<li><p><a class="reference internal" href="#try-it-out" id="id5">Try it out</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="method">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Method</a><a class="headerlink" href="#method" title="Link to this heading"></a></h2>
<p>The data collection procedure involves manually jogging the robot to do an assembly/disassembly task during which camera and robot data is recorded.</p>
<p>It is assumed that the system setup (like, camera calibration) is done before data collection procedure.</p>
<p id="data-collection"><img alt="data-collection" src="../../_images/vision-data-collection.png" />
<em><center>Data collection procedure for an insertion placement task</center></em></p>
<!-- <iframe width="704" height="396" src="https://www.youtube.com/embed/yKXflZ4BOYs" title="Vision Based Insertion - Training Procedure" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>  -->
</section>
<section id="code-overview">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Code Overview</a><a class="headerlink" href="#code-overview" title="Link to this heading"></a></h2>
<p><a href="https://github.com/cmu-mfi/rtc_vision_toolbox" class="inline-button"><i class="fab fa-github"></i>rtc_vision_toolbox</a></p>
<p><img alt="classes" src="../../_images/teach-classes.png" /></p>
<ul class="simple">
<li><p>rtc_core classes: These are defined in the rtc_core folder</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Devices</span></code> class is used to define the devices used in the system. It is used to define the camera and robot used in the system. It uses a config file to intialize the required device classes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TeachPlace</span></code> class is used to define the data collection procedure for an insertion task. It uses the <code class="docutils literal notranslate"><span class="pre">Devices</span></code> class to initialize the camera and robot.</p></li>
</ul>
<p>All the blocks in <a class="reference internal" href="#data-collection"><span class="std std-ref">data collection procedure</span></a> are implemented in the <code class="docutils literal notranslate"><span class="pre">TeachPlace</span></code> class in <code class="docutils literal notranslate"><span class="pre">rtc_core/place_skill/place_teach.py</span></code>.</p>
<p>Refer <code class="docutils literal notranslate"><span class="pre">scripts/place_teach.py</span></code> to see how to use the <code class="docutils literal notranslate"><span class="pre">TeachPlace</span></code> class to collect data.</p>
</section>
<section id="useful-tips">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Useful Tips</a><a class="headerlink" href="#useful-tips" title="Link to this heading"></a></h2>
<ul>
<li><p><strong>Configuration file is important</strong></p>
<ul class="simple">
<li><p>All the parameters are defined in one <code class="docutils literal notranslate"><span class="pre">.yaml</span></code> file. <code class="docutils literal notranslate"><span class="pre">demo-example/demonstrations/08-14-wp/place_object.yaml</span></code> is an example of a configuration file.</p></li>
<li><p>It includes devices to initialize, the task to perform, and the data collection procedure.</p></li>
</ul>
</li>
<li><p><strong>Configuration Parameters</strong></p>
<ul class="simple">
<li><p>Variation parameters should be representative of deployment conditions. Parameters to keep in mind:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">num_demos</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">training.test_ratio</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">training.action.view_variations</span></code>/<code class="docutils literal notranslate"><span class="pre">training.action.pose_variations</span></code>: Use 1 for no variation <em>(recommended)</em>. Use a higher number for more variation, if the system needs to be more reliable.</p></li>
<li><p>Varying Initial Gripper Pose at every demo cycle.
Make sure to vary the gripper pose as much as you expect in the deployment scenario. If you expect, for example, the action object to be held +/- 5deg, then make sure to vary the gripper pose by at least that much in the data collection procedure.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Data Quality</strong></p>
<ul class="simple">
<li><p>Parameters in the configuration file should be set to ensure good data quality:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">training.action.viewing_distance</span></code> and <code class="docutils literal notranslate"><span class="pre">training.anchor.viewing_distance</span></code> <br />
Different cameras have different focal lengths. The distance from the camera should be set to ensure the object is in focus.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">training.action.view_variations</span></code> and <code class="docutils literal notranslate"><span class="pre">training.anchor.view_variations</span></code> <br />
Aggresive variations can lead to object occlusion, which can lead to bad data samples.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">devices.cameras.&lt;camera</span> <span class="pre">name&gt;.setup</span></code> <br />
Calibration matrix for each camera is important that it is correct. It is used to pose the object in the camera frame.</p></li>
</ul>
</li>
<li><p>Monitor images saved during data collection to ensure the quality of data. <a class="reference internal" href="#table-good-bad"><span class="std std-ref">Table</span></a> below shows good and bad data samples.</p>
<ul>
<li><p>It can be seen from the bad depth image that the features of the connector are not captured, which is evident in the point too. In this case, the difference is the distance from the camera. The object is too close to the camera in the bad image.</p></li>
</ul>
</li>
</ul>
<table class="docutils align-default" id="table-good-bad">
<thead>
<tr class="row-odd"><th class="head"><p>Good</p></th>
<th class="head"><p>Bad</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><img alt="" src="../../_images/good_view0_rgb.png" /></p></td>
<td><p><img alt="" src="../../_images/bad_view1_rgb.png" /></p></td>
</tr>
<tr class="row-odd"><td><p><img alt="" src="../../_images/good_view0_depth.png" /></p></td>
<td><p><img alt="" src="../../_images/bad_view1_depth.png" /></p></td>
</tr>
<tr class="row-even"><td><p><img alt="" src="../../_images/good_pcd.png" /></p></td>
<td><p><img alt="" src="../../_images/bad_pcd.png" /></p></td>
</tr>
</tbody>
</table>
</li>
</ul>
</section>
<section id="try-it-out">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Try it out</a><a class="headerlink" href="#try-it-out" title="Link to this heading"></a></h2>
<insert gazebo sim></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="calibration.html" class="btn btn-neutral float-left" title="Robot-Camera Calibration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="training-model.html" class="btn btn-neutral float-right" title="LEARN - Training a model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright CMU.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>