

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LEARN - Training a model &mdash; Robotics Training Center 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=9951d260" />
      <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" />

  
    <link rel="shortcut icon" href="../../_static/Firefly a robot arm doing assembly task, industry 4.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=30646c52"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="EXECUTE - Skill Execution" href="execution.html" />
    <link rel="prev" title="TEACH - Collecting Data" href="data-collection.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Robotics Training Center
              <img src="../../_static/Firefly a robot arm doing assembly task, industry 4.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../System.html">System Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../System.html#cmu-research-setup">CMU Research Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../System.html#bom">BOM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Highlights.html">Video Highlights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Contact.html">Contact</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vision System</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Vision.html">Vision System - Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Vision.html#teach-data-collection">TEACH: Data Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Vision.html#learn-model-training">LEARN: Model Training</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../Vision.html#data-input-for-training">Data input for training:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../Vision.html#execute-model-inference">EXECUTE: Model Inference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Vision System - Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../Installation.html#hardware">Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation.html#software">Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Installation.html#installation-steps">Installation Steps</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../Tutorial.html">Vision System - Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="calibration.html">Robot-Camera Calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#method-eye-on-base">Method: eye-on-base</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#method-eye-on-hand">Method: eye-on-hand</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#code-overview">Code Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#try-it-out">Try it out</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#useful-tips">Useful Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="calibration.html#calibration-algorithms">Calibration Algorithms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="calibration.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data-collection.html">TEACH - Collecting Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data-collection.html#method">Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-collection.html#code-overview">Code Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-collection.html#useful-tips">Useful Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-collection.html#try-it-out">Try it out</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">LEARN - Training a model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#method">Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-overview">Code Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration-files">Configuration Files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#try-it-out">Try it out</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="execution.html">EXECUTE - Skill Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="execution.html#method">Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="execution.html#code-overview">Code Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="execution.html#useful-tips">Useful Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="execution.html#try-it-out">Try it out</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vibrotactile System</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html">Vibrotactile System - Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#teach-data-collection">TEACH: Data Collection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#nist-data-collection">NIST Data Collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#lego-data-collection">LEGO Data Collection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#learn-model-training">LEARN: Model Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#execute-model-inference">EXECUTE: Model Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#waterproof-online-inference">Waterproof Online Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Vibrotactile.html#d-sub-online-inference">D-SUB Online Inference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../Vibrotactile/Installation.html">Vibrotactile System - Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Vibrotactile/Installation.html#hardware">Hardware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Installation.html#mandatory">Mandatory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Installation.html#optional">Optional</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../Vibrotactile/Installation.html#software">Software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Vibrotactile/Installation.html#installation-steps">Installation Steps</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Digital Data Backbone</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../DDB/DDB.html">Digital Data Backbone - Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/DDB.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/DDB.html#layers">Layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/DDB.html#current-capability">Current Capability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/DDB.html#software">Software</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../DDB/Installation.html">DDB - Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/Installation.html#step-1-broker-setup-pub-sub-broker-layer">Step 1: Broker Setup (Pub-Sub Broker Layer)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/Installation.html#step-2-cloud-databases-cloud-storage-layer">Step 2: Cloud Databases (Cloud Storage Layer)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/Installation.html#aveva-pi-historian">Aveva PI Historian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/Installation.html#sql">SQL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../DDB/Installation.html#cloud-file-storage">Cloud File Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/Installation.html#step-4-event-listeners">Step 4: Event Listeners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/Installation.html#step-5-retrieval-services">Step 5: Retrieval Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../DDB/Installation.html#system-checks-and-troubleshooting">System Checks and Troubleshooting</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Robotics Training Center</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Tutorial.html">Vision System - Tutorials</a></li>
      <li class="breadcrumb-item active">LEARN - Training a model</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/cmu-mfi/rtc/blob/main/doc/Vision/Tutorials/training-model.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="learn-training-a-model">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">LEARN - Training a model</a><a class="headerlink" href="#learn-training-a-model" title="Link to this heading"></a></h1>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#learn-training-a-model" id="id1">LEARN - Training a model</a></p>
<ul>
<li><p><a class="reference internal" href="#method" id="id2">Method</a></p></li>
<li><p><a class="reference internal" href="#code-overview" id="id3">Code Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#configuration-files" id="id4">Configuration Files</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#try-it-out" id="id5">Try it out</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="method">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Method</a><a class="headerlink" href="#method" title="Link to this heading"></a></h2>
<p>A trained model is used for estimating corss-pose between action and achor pointclouds. Details for the model can be found here: <a class="reference external" href="https://arxiv.org/pdf/2211.09325">TAX-Pose Paper</a></p>
<p><img alt="taxpose" src="../../_images/vision-taxpose-overview.gif" /></p>
</section>
<section id="code-overview">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Code Overview</a><a class="headerlink" href="#code-overview" title="Link to this heading"></a></h2>
<p><a href="https://github.com/cmu-mfi/rtc_vision_toolbox" class="inline-button"><i class="fab fa-github"></i>rtc_vision_toolbox</a></p>
<p><img alt="taxpose" src="../../_images/vision-learn.png" /></p>
<ul class="simple">
<li><p>There are two steps involved in training a model, which is represented in the above image: <strong>preparing the dataset</strong>, and <strong>training the model</strong>.
<br><br></p></li>
</ul>
<section id="configuration-files">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Configuration Files</a><a class="headerlink" href="#configuration-files" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Prepare Dataset:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/cmu-mfi/rtc_vision_toolbox/blob/2e8f252589e442153d5d982172b98cc352207988/demo-example/demonstrations/08-14-wp/place_object.yaml">Sample config file</a></p></li>
<li><p>Same configuration file  as the one used for collecting data.</p></li>
<li><p>Key parameters:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">devices.cameras.&lt;camera</span> <span class="pre">name&gt;.setup</span></code>: Camera calibrations are important to transform action object and anchor object pointclouds correctly.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">training.action.object_bounds</span></code> <code class="docutils literal notranslate"><span class="pre">training.anchor.object_bounds</span></code>: The bounding box is used to crop the pointcloud to the object of interest.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Train Model:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/cmu-mfi/taxpose/blob/d65796b06c85e62295f890ec7ae1f9289f6d25b6/configs/commands/mfi/waterproof/train_taxpose_08-14-wp_place.yaml">Sample config file</a></p></li>
<li><p>The configuration for training is defined under <a class="reference external" href="https://github.com/cmu-mfi/taxpose/tree/d65796b06c85e62295f890ec7ae1f9289f6d25b6/configs">taxpose</a> repo.</p></li>
<li><p>If defining a new task and/or a new setup, each folder in the <code class="docutils literal notranslate"><span class="pre">config</span></code> directory should have respective object/task/scene definition.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">train_residual_flow.py</span></code> uses <a class="reference external" href="https://hydra.cc/">hydra</a> to resolve the configuration files.</p></li>
<li><p>Primary configuration file is under <code class="docutils literal notranslate"><span class="pre">configs/commands</span></code> directory that is linked above in first bullet.</p></li>
<li><p>Key parameters:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">dataset_root</span></code>: Path to the train/test prepared dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_num_points</span></code>: Action and anchor pointclouds are downsampled to this number of points. Higher number of points will improve the accuracy but will increase the training time. So if the connectors have intricate features, it is better to keep this number high. Otherwise, a lower number of points will suffice. Reduce the number if you get error about points being lesser than the minimum number of points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">batch_size</span></code>: Number of samples in each batch. Higher number will increase the training time and memory requirements but will improve the accuracy. Batch size 8 with 2048 min_num_points required 20GB of GPU memory. So, if you have a smaller GPU, reduce the batch size.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_epochs</span></code>: Number of epochs to train the model. 4000 epochs are more than enough to train the model. The model usually converges within 1000 epochs. More epochs, more training time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wandb.entity</span></code>: Enter your wandb username. If you don’t want to use wandb (<em>not recommended</em>), set WANDB_MODE=disabled before running the script.</p></li>
</ul>
</li>
</ul>
</li>
</ol>
<p><em>Note: We want to integrate training routine in <code class="docutils literal notranslate"><span class="pre">rtc_core.place_skill.place_learn.learn</span></code> method. This will allow the user to train the model using same script, and configure the training parameters in one configuration file. Contributions are welcome.</em></p>
</section>
</section>
<section id="try-it-out">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Try it out</a><a class="headerlink" href="#try-it-out" title="Link to this heading"></a></h2>
<p><em>…todo…</em></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="data-collection.html" class="btn btn-neutral float-left" title="TEACH - Collecting Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="execution.html" class="btn btn-neutral float-right" title="EXECUTE - Skill Execution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright CMU.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>